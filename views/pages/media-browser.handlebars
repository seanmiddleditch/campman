{{>layouts/page title='Media' page_icon='files-o'}}

{{#*inline "head"}}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css" integrity="sha256-HAaDW5o2+LelybUhfuk0Zh2Vdk8Y2W2UeKmbaXhalfA=" crossorigin="anonymous" />
{{/inline}}

{{#*inline "scripts"}}
<script>
function DeleteMedia(ev, path) {
    ev.preventDefault()
    const media = new MediaAPI()
    if (confirm('Are you sure you want to delete this file?'))
        media.delete(path)
            .then(() => window.location.reload(true))
            .catch(err => alert(err))
}
</script>
{{/inline}}

{{#*inline "content"}}
{{#if canUpload}}
<button class='btn btn-primary' onClick='ShowMediaUploadDialog()'><i class='fa fa-upload'></i> Upload</button>
{{/if}}
<div class='clearfix'>
{{#each media}}
    <div class='card float-left m-2' style='width: 12rem; height: 16rem'>
        <div style='height: 140px; overflow: hidden'><a href='{{this.url}}'><img src='{{this.thumb_url}}' class='card-img-top' alt='{{this.caption}}'/></a></div>
        <div class='card-body'>
            <h5 class='card-title'>{{#if this.caption}}{{this.caption}}{{else}}{{this.path}}{{/if}}</h5>
            <a href='{{this.url}}' class='btn btn-link'><i class='fa fa-search-plus'></i></a>
            <button disabled class='btn btn-link'><i class='fa fa-pencil'></i></button>
            {{#if ../canDelete}}<button class='btn btn-link pull-right' onClick='DeleteMedia(event, "{{this.path}}")'><i class='fa fa-trash-o'></i></button>{{/if}}
        </div>
    </div>
{{else}}
    <div class='alert alert-warning'>No results</div>
{{/each}}
</div>
{{/inline}}